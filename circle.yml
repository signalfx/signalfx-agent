machine:
    environment:
        DEBIAN_FRONTEND: noninteractive
        GODIST: "go1.8.3.linux-amd64.tar.gz"
    post:
    - sudo add-apt-repository -y ppa:masterminds/glide
    - sudo apt-get update
    - sudo apt-get install -y glide
    - mkdir -p download
    - test -e download/$GODIST || curl -o download/$GODIST https://storage.googleapis.com/golang/$GODIST
    - sudo rm -rf /usr/local/go
    - sudo tar -C /usr/local -xzf download/$GODIST

dependencies:
    override:
    - mkdir -p ~/.go_workspace/src/github.com/signalfx
    - ln -s ~/neo-agent ~/.go_workspace/src/github.com/signalfx/neo-agent
    - glide install:
        pwd: ../.go_workspace/src/github.com/signalfx/neo-agent
    - make install:
        pwd: collectd-ext/stub

    cache_directories:
    - vendor
    - ~/download

test:
    override:
    - scripts/circle.sh test
