<!--- GENERATED BY gomplate from scripts/docs/monitor-page.md.tmpl --->

# cadvisor

This monitor pulls metrics directly from cadvisor, which
conventionally runs on port 4194, but can be configured to anything.  If you
are running on Kubernetes, consider the [kubelet-stats](./kubelet-stats.md)
monitor because many K8s nodes do not expose cAdvisor on a network port,
even though they are running it within Kubelet.

If you are running containers with Docker, there is a fair amount of
duplication with the `collectd/docker` monitor in terms of the metrics sent
(under distinct metric names) so you may want to consider not enabling the
Docker monitor in a K8s environment, or else use filtering to whitelist only
certain metrics.  Note that this will cause the built-in Docker dashboards
to be blank, but container metrics will be available on the Kubernetes
dashboards instead.


Monitor Type: `cadvisor`

[Monitor Source Code](https://github.com/signalfx/signalfx-agent/tree/master/internal/monitors/cadvisor)

**Accepts Endpoints**: No

**Multiple Instances Allowed**: Yes

## Configuration

| Config option | Required | Type | Description |
| --- | --- | --- | --- |
| `cadvisorURL` | no | `string` | Where to find cAdvisor (**default:** `http://localhost:4194`) |




## Metrics

The following table lists the metrics available for this monitor. Metrics that are marked as Included are standard metrics and are monitored by default.

| Name | Type | Included | Description |
| ---  | ---  | ---    | ---         |
| `container_cpu_cfs_periods` | cumulative |  | Total number of elapsed CFS enforcement intervals |
| `container_cpu_cfs_throttled_periods` | cumulative |  | Total number of times tasks in the cgroup have been throttled |
| `container_cpu_cfs_throttled_time` | cumulative |  | Total time duration, in nanoseconds, for which tasks in the cgroup have been throttled |
| `container_cpu_percent` | cumulative |  | Cumulative cpu utilization as a percentage of the total host CPU available.  This metric is equivalent to `container_cpu_utilization` / <# of CPUs/cores on host>. |
| `container_cpu_system_seconds_total` | cumulative |  | Cumulative system cpu time consumed in nanoseconds |
| `container_cpu_usage_seconds_total` | cumulative |  | Cumulative cpu time consumed per cpu in nanoseconds |
| `container_cpu_user_seconds_total` | cumulative |  | Cumulative user cpu time consumed in nanoseconds |
| `container_cpu_utilization` | cumulative | ✔ | Cumulative cpu utilization in percentages.  This is equivalent to "centicores", or hundreths of CPU cores consumed.  This metric is **NOT** normalized by the total # of cores on the system. |
| `container_cpu_utilization_per_core` | cumulative |  | Cumulative cpu utilization in percentages per core |
| `container_fs_io_current` | gauge |  | Number of I/Os currently in progress |
| `container_fs_io_time_seconds_total` | cumulative |  | Cumulative count of seconds spent doing I/Os |
| `container_fs_io_time_weighted_seconds_total` | cumulative |  | Cumulative weighted I/O time in seconds |
| `container_fs_limit_bytes` | gauge |  | Number of bytes that the container may occupy on this filesystem |
| `container_fs_read_seconds_total` | cumulative |  | Cumulative count of seconds spent reading |
| `container_fs_reads_merged_total` | cumulative |  | Cumulative count of reads merged |
| `container_fs_reads_total` | cumulative |  | Cumulative count of reads completed |
| `container_fs_sector_reads_total` | cumulative |  | Cumulative count of sector reads completed |
| `container_fs_sector_writes_total` | cumulative |  | Cumulative count of sector writes completed |
| `container_fs_usage_bytes` | gauge |  | Number of bytes that are consumed by the container on this filesystem |
| `container_fs_write_seconds_total` | cumulative |  | Cumulative count of seconds spent writing |
| `container_fs_writes_merged_total` | cumulative |  | Cumulative count of writes merged |
| `container_fs_writes_total` | cumulative |  | Cumulative count of writes completed |
| `container_last_seen` | gauge |  | Last time a container was seen by the exporter |
| `container_memory_failcnt` | cumulative |  | Number of memory usage hits limits |
| `container_memory_failures_total` | cumulative | ✔ | Cumulative count of memory allocation failures |
| `container_memory_usage_bytes` | gauge | ✔ | Current memory usage in bytes |
| `container_memory_working_set_bytes` | gauge |  | Current working set in bytes |
| `container_spec_cpu_period` | gauge | ✔ | The number of microseconds that the [CFS scheduler](https://www.kernel.org/doc/Documentation/scheduler/sched-bwc.txt) uses as a window when limiting container processes |
| `container_spec_cpu_quota` | gauge | ✔ | In CPU quota for the CFS process scheduler. In K8s this is equal to the containers's CPU limit as a fraction of 1 core and multiplied by the `container_spec_cpu_period`.  So if the CPU limit is `500m` (500 millicores) for a container and the `container_spec_cpu_period` is set to 100,000, this value will be 50,000. |
| `container_spec_cpu_shares` | gauge |  | CPU share of the container |
| `container_spec_memory_limit_bytes` | gauge | ✔ | Memory limit for the container. |
| `container_spec_memory_swap_limit_bytes` | gauge |  | Memory swap limit for the container. |
| `container_start_time_seconds` | gauge |  | Start time of the container since unix epoch in seconds. |
| `container_tasks_state` | gauge |  | Number of tasks in given state |
| `machine_cpu_cores` | gauge | ✔ | Number of CPU cores on the node. |
| `machine_cpu_frequency_khz` | gauge |  | Node's CPU frequency. |
| `machine_memory_bytes` | gauge | ✔ | Amount of memory installed on the node. |
| `pod_network_receive_bytes_total` | cumulative | ✔ | Cumulative count of bytes received |
| `pod_network_receive_errors_total` | cumulative | ✔ | Cumulative count of errors encountered while receiving |
| `pod_network_receive_packets_dropped_total` | cumulative |  | Cumulative count of packets dropped while receiving |
| `pod_network_receive_packets_total` | cumulative |  | Cumulative count of packets received |
| `pod_network_transmit_bytes_total` | cumulative | ✔ | Cumulative count of bytes transmitted |
| `pod_network_transmit_errors_total` | cumulative | ✔ | Cumulative count of errors encountered while transmitting |
| `pod_network_transmit_packets_dropped_total` | cumulative |  | Cumulative count of packets dropped while transmitting |
| `pod_network_transmit_packets_total` | cumulative |  | Cumulative count of packets transmitted |


To specify custom metrics you want to monitor, add a `metricsToInclude` filter
to the agent configuration, as shown in the code snippet below. The snippet
lists all available custom metrics. You can copy and paste the snippet into
your configuration file, then delete any custom metrics that you do not want
sent.

Note that some of the custom metrics require you to set a flag as well as add
them to the list. Check the monitor configuration file to see if a flag is
required for gathering additional metrics.

```yaml

metricsToInclude:
  - metricNames:
    - container_cpu_cfs_periods
    - container_cpu_cfs_throttled_periods
    - container_cpu_cfs_throttled_time
    - container_cpu_percent
    - container_cpu_system_seconds_total
    - container_cpu_usage_seconds_total
    - container_cpu_user_seconds_total
    - container_cpu_utilization_per_core
    - container_fs_io_current
    - container_fs_io_time_seconds_total
    - container_fs_io_time_weighted_seconds_total
    - container_fs_limit_bytes
    - container_fs_read_seconds_total
    - container_fs_reads_merged_total
    - container_fs_reads_total
    - container_fs_sector_reads_total
    - container_fs_sector_writes_total
    - container_fs_usage_bytes
    - container_fs_write_seconds_total
    - container_fs_writes_merged_total
    - container_fs_writes_total
    - container_last_seen
    - container_memory_failcnt
    - container_memory_working_set_bytes
    - container_spec_cpu_shares
    - container_spec_memory_swap_limit_bytes
    - container_start_time_seconds
    - container_tasks_state
    - machine_cpu_frequency_khz
    - pod_network_receive_packets_dropped_total
    - pod_network_receive_packets_total
    - pod_network_transmit_packets_dropped_total
    - pod_network_transmit_packets_total
    monitorType: cadvisor
```


## Dimensions

The following dimensions may occur on metrics emitted by this monitor.  Some
dimensions may be specific to certain metrics.

| Name | Description |
| ---  | ---         |
| `container_id` | The ID of the running container |
| `container_image` | The container image name |
| `container_name` | The container's name as it appears in the pod spec, the same as container_spec_name but retained for backwards compatibility. |
| `container_spec_name` | The container's name as it appears in the pod spec |
| `kubernetes_namespace` | The K8s namespace the container is part of |
| `kubernetes_pod_name` | The pod instance under which this container runs |
| `kubernetes_pod_uid` | The UID of the pod instance under which this container runs |



